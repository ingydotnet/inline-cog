#!/bin/bash

die() { echo "$@"; exit 1; }

Cog.main() {
  local command_name= command_args=
  setup-environment "$@"
  Cog::Command.$command_name "${command_args[@]}"
}

setup-environment() {
  local command_path= command_lib=
  command_name=${1:-help}
  shift
  command_args=( "$@" )
  command_path="$(dirname $0)"
  command_path="${command_path:-.}"
  COG_ROOT="$PWD"
  command_lib="$command_path/cog-$command_name"
  [ -e "$command_lib" ] ||
    die "Unknown command: '$command_name'"
  source "$command_lib"
}

[ "$0" != "$BASH_SOURCE" ] || Cog.main "$@"
